---
title: A Unified Model of Derivative Securities
author: Keith A. Lewis
institution: KALX, LLC
email: kal@kalx.net
classoption: fleqn
abstract: |
	Every arbitrage-free model of prices and cash flows
	is parameterized by a positive, adapted process and
	a vector-valued martingale whose components are
	indexed by market instruments.
...

A _derivative security_ is a contract between two parties: I will
give you this on these dates if you will give me that on those dates.
Derivatives must have existed since before recorded history.  The Nobel
prize winning breakthrough of Black, Scholes, and Merton was to show
how to synthesize derivatives by dynamically trading market instruments.

## Notation

If $\AA$ is an
[algebra](https://en.wikipedia.org/wiki/Algebra_of_sets)
on the set $\Omega$ we write
$X\colon\AA\to\mathbf{R}$ to indicate $X\colon\Omega\to\mathbf{R}$
is $\AA$-[_measurable_](https://en.wikipedia.org/wiki/Measurable_function).
If $\AA$ is finite then the
[atoms](https://en.wikipedia.org/wiki/Atom_(measure_theory))
of $\AA$ form a
[partition](https://en.wikipedia.org/wiki/Partition_of_a_set)
of $\Omega$ and being measurable is
equivalent to being constant on atoms. In this case $X$ is indeed a function
on the atoms.

If $\AA$ is an algebra of sets, the
[_conditional expectation_](https://en.wikipedia.org/wiki/Conditional_expectation)
of $X$ given
$\AA$ is defined by $Y = E\left\lbrack X \mid \AA\right\rbrack$ if and only
if $Y$ is $\AA$ measurable and $\int_A Y\,dP = \int_A X\,dP$
for all $A\in\AA$. This is equivalent to $Y(P|_\AA)
= (XP)|_\AA$ where the vertical bar indicates restriction of a measure.

A _filtration_ indexed by $T\subseteq [0,\infty)$ is an increasing
collection of algebras, $(\AA_t)_{t\in T}$.  A process
$M_{t}\colon\AA_{t} \rightarrow \mathbf{R}$, $t\in T$, is
a _martingale_ if $M_t = E[M_u\mid \AA_t] = E_t[M_u]$ for $t\le u$.

A _stopping time_ is a function $\tau\colon\Omega\to T$ such that
$\{\omega\in\Omega\mid \tau(\omega) \le t\}$ belongs to $\AA_t$, $t\in T$.

## Market Model

Every _instrument_ has a _price_, $X_t$, and a _cash flow_, $C_t$, at any
trading time, $t\in T$.  Instruments are assumed to be perfectly liquid:
they can be bought or sold at the given price in any amount. Cash flows
are associated with owning an instrument and are almost always 0: stocks
have dividends, bonds have coupons, European options have exactly one
cash flow at expiration, futures always have price 0.

A _market model_ specifies _prices_
$X_{t}:\AA_{t} \rightarrow \mathbf{R}^{I}$, and _cash flows_
$C_{t}:\AA_{t} \rightarrow \mathbf{R}^{I}$, where $I$ are the
available market instruments.

## Trading

A _trading strategy_ is a finite collection of strictly increasing
stopping times, $\tau_{j}$, and trades, $\Gamma_{j}:\AA_{\tau_{j}}
\rightarrow \mathbf{R}^{I}$ indicating the number of shares to trade
in each instrument. Trades accumulate to a _position_, $\Delta_{t} =
\sum_{\tau_{j} < t}\Gamma_{j} = \sum_{s < t}\Gamma_{s}$ where $\Gamma_{s}
= \Gamma_{j}$ when $s = \tau_{j}$.  Note the trade at time $t$ is not
included in the position at time $t$: it takes some time for trades
to settle.

The _value_ (or _mark-to-market_) of a position at time $t$ is $V_{t} =
\left( \Delta_{t} + \Gamma_{t} \right) \cdot X_{t}$: what you would get
from liquidating your existing position and the trades just executed.
The _amount_ generated by the trading strategy at time $t$ is $A_{t} =
\Delta_{t} \cdot C_{t} - \Gamma_{t} \cdot X_{t}$: you receive the cash
flows associated with your existing position and pay for the trades you
just executed.

## Arbitrage

Arbitrage is a trading strategy with $A_{\tau_{0}} > 0$, $A_{t} \geq 0$
for $t > \tau_{0}$ and $\sum_{j}^{}{\Gamma_{j} = 0}$: you make money
on the first trade and never lose until the strategy is closed out.

The Fundamental Theorem of Asset Pricing is that there is no arbitrage
if and only if there exists a _deflator_, $D_{t}:\AA_{t} \rightarrow \left(
0,\infty \right)$, with

$$\begin{matrix}
X_{t}D_{t} = E_t[X_v D_v + \sum_{t < u \leq v} C_u D_u].\label{eq:1} \\
\end{matrix}$$

Note that if $C_t = 0$ for all $t \in T$, this says $X_tD_t$ is a
martingale. If the prices are eventually 0, this says the current price
is the expected price of discounted future cash flows.  A consequence
of the above and the definition of value and amount is

$$\begin{matrix}
V_t D_t = E_t[V_v D_v + \sum_{t < u \leq v}A_u D_u].\label{eq:2} \\
\end{matrix}$$

Note the similarity to the previous displayed equation. The value
corresponds to price and the amount corresponds to cash flow.

If $u > t$ is sufficiently small then $X_t D_t = E_t[(X_u + C_u) D_u]$
and $V_t D_t = (\Delta_{t} + \Gamma_t)\cdot X_{t} D_t = \Delta_u\cdot
E_t[(X_u + C_u) D_u]$.  Since $\Delta_u\cdot C_u = \Gamma_u\cdot X_u +
A_u$ we have $V_t D_t = E_t[(\Delta_u\cdot X_u + \Gamma_u\cdot X_u +
A_u) D_u] = E_t[(V_u + A_u)D_u]$. The formula above follows by induction.

For a trading strategy that closes out, $V_{\tau_0} D_{\tau_0} =
E_{\tau_0}[\sum_{t > \tau_{0}}{A_{t}D_{t}] \geq 0}$.  Since $V_{\tau_0} =
\Gamma_{\tau_0} \cdot X_{\tau_0}$, $A_{\tau_0} = - \Gamma_{\tau_0} \cdot X_{\tau_0}$, and $D_{\tau_0} > 0$ we have
$A_{\tau_0} \leq 0$.
This proves the "easy" direction of the FTAP.

There is no need to prove the "hard" direction since we have a large supply of arbitrage free models:
every model of the form
$X_{t}D_{t} = M_{t} - \sum_{s \leq t}{C_{s}D_{s}}$ where
$M_{t}:\AA_{t} \rightarrow \mathbf{R}^{I}$ is a martingale and
$D_{t}:\AA_{t} \rightarrow (0,\infty)$ 
is arbitrage-free. This is immediate by substituting
$X_{v}D_{v} = M_v - \sum_{s\le v} C_s D_s$ in the first displayed equation.

For example, the Black-Scholes/Merton model is specified by
$M_t = (r, s\exp(\sigma B_t - \sigma^2t/2)$ and $D_t = \exp(-\rho t)$.
No need for Ito's lemma or PDE's.

The fundamental theorem of asset pricing places constraints on prices
and cash flows. A _zero coupon bond_ pays one unit at maturity $u$ so
it has a cash flow of 1 unit at time $u$.
An arbitrage free model requires the price at time $t$, $D_t(u)$, to
satisfy $D_t(u)D_t = E_t D_u$.

## Canonical Deflator

There is a canonical choice for a deflator if repurchase agreements are available.

A _repurchase agreement_ at time $t$, $R_t$, has price $X^{R_t}_t = 1$
and cash flow $C^{R_t}_{t + dt} = R_t$ so for any arbitrage free model
$D_t = E_t[R_tD_{t+dt}]$.  Define the _forward repo rate_, $f_t$,
by $R_t = \exp(f_t\,dt)$ and the _canonical deflator_ to be $D_t =
\exp(-\int_0^t f_s\,ds)$.  The repos are arbitrage free for any forward
repo rate process.


## Hedging

Given a derivative contract paying amounts $A_j$ at times $\tau_j$,
how does one value this? One way is to find a trading strategy that
replicates the payments.  The value is just the cost to set up the
initial trading strategy, $V_0 = \Gamma_0\cdot X_0$.
The initial hedge is $\Gamma_0 = dV_0/dX_0$.
From $V_0 = E_0 \sum_{\tau_j} A_j D_{\tau_j}$ we can compute this in
terms of the contract amounts and deflators.

The trades at time $t$ are similarly determined by $\Delta_t + \Gamma_t =
dV_t/dX_t$, where the last term is the Fr&#233;chet derivative.  Since we
know the position, $\Delta_t$, at time $t$ this determines the trades,
$\Gamma_t = dV_t/dX_t - \Delta_t$.

This will not replicate the derivative security. There is still
significant research to be done on how to minimize the risk involved
with this.

In the continuous time case where stocks are modelled by geometric
Brownian motion, this becomes classical Black-Scholes/Merton
delta hedging where delta is $\Delta$ and gamma is $\Gamma$. 
